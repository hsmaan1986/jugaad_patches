function SocialToolsClass(wrapper,url,sharedtitle){if($(wrapper).length==0){this.Wrapper=$('.'+wrapper);}else{this.Wrapper=$(wrapper);}
this.CurrentUrl=url||document.location;this.CurrentUrlEncoded=encodeURI(this.CurrentUrl);this.CurrentTitle=sharedtitle;this.CurrentTitleEncoded=encodeURI(this.CurrentTitle);this.FacebookAnchor=$(this.Wrapper).find('.facebook a');this.TwitterAnchor=$(this.Wrapper).find('.twitter a');this.LinkedInAnchor=$(this.Wrapper).find('.linkedin a');this.GooglePlusAnchor=$(this.Wrapper).find('.googleplus a');this.WeiboAnchor=$(this.Wrapper).find('.weibo a');this.SohuAnchor=$(this.Wrapper).find('.sohu a');this.RenRenAnchor=$(this.Wrapper).find('.renren a');this.QQAnchor=$(this.Wrapper).find('.qq a');this.SendPageAnchor=$(this.Wrapper).find('.sendpage a');this.HideFacebook=$(this.Wrapper).find('#HideFacebook').val()==1;this.HideTwitter=$(this.Wrapper).find('#HideTwitter').val()==1;this.HideLinkedIn=$(this.Wrapper).find('#HideLinkedIn').val()==1;this.HideGooglePlus=$(this.Wrapper).find('#HideGooglePlus').val()==1;this.HideWeibo=$(this.Wrapper).find('#HideWeibo').val()==1;this.HideSohu=$(this.Wrapper).find('#HideSohu').val()==1;this.HideQQ=$(this.Wrapper).find('#HideQQ').val()==1;this.HideRenRen=$(this.Wrapper).find('#HideRenRen').val()==1;this.HideSendPage=$(this.Wrapper).find('#HideSendPage').val()==1;this.SendPageUrl=$(this.Wrapper).find('#SendPageUrl').val()==1;this.GlobalCountWrapper=$(this.Wrapper).find('.globalcount div:first-child');this.DeployButton=$(this.Wrapper).find('.SocialToolsButton');this.ListContainer=$(this.Wrapper).find('ul');this.ListSelector=$(this.Wrapper).find('ul li');this.ListGlobalCountSelector=$(this.Wrapper).find('.globalcount');this.SocialButtonTooltipSelector=$(this.Wrapper).find('.labelsocialbuttontooltip');this.MininumShareToDisplayCounter=$(this.Wrapper).find('#MininumShareToDisplayCounter').val();if(this.FacebookAnchor.length>0){$(this.FacebookAnchor).click({context:this},function(eventObject){eventObject.data.context.AddCount('Facebook');});}
if(this.TwitterAnchor.length>0){$(this.TwitterAnchor).click({context:this},function(eventObject){eventObject.data.context.AddCount('Twitter');});}
if(this.LinkedInAnchor.length>0){$(this.LinkedInAnchor).click({context:this},function(eventObject){eventObject.data.context.AddCount('LinkedIn');});}
if(this.GooglePlusAnchor.length>0){$(this.GooglePlusAnchor).click({context:this},function(eventObject){eventObject.data.context.AddCount('GooglePlus');});}
if(this.WeiboAnchor.length>0){$(this.WeiboAnchor).click({context:this},function(eventObject){eventObject.data.context.AddCount('Weibo');});}
if(this.RenRenAnchor.length>0){$(this.RenRenAnchor).click({context:this},function(eventObject){eventObject.data.context.AddCount('RenRen');});}
if(this.QQAnchor.length>0){$(this.QQAnchor).click({context:this},function(eventObject){eventObject.data.context.AddCount('QQ');});}
this.UpdateDesign();this.InitFacebookShare();this.InitTwitterShare();this.InitLinkedInShare();this.InitGooglePlusShare();this.InitWeiboShare();this.InitSohuShare();this.InitQQShare();this.InitRenRenShare();this.InitSendPageShare();$(this.Wrapper).removeAttr("style");this.InitCounters();};SocialToolsClass.prototype.UpdateDesign=function(){var mobileView=$('.device1').length>0;var ElementCount=mobileView?0:1;if(this.FacebookAnchor.length>0){ElementCount+=1;}
if(this.TwitterAnchor.length>0){ElementCount+=1;}
if(this.LinkedInAnchor.length>0){ElementCount+=1;}
if(this.GooglePlusAnchor.length>0){ElementCount+=1;}
if(this.WeiboAnchor.length>0){ElementCount+=1;}
if(this.SohuAnchor.length>0){ElementCount+=1;}
if(this.RenRenAnchor.length>0){ElementCount+=1;}
if(this.QQAnchor.length>0){ElementCount+=1;}
if(this.SendPageAnchor.length>0){ElementCount+=1;}
var containerWidth=this.ListContainer.css('width').replace('px','');var elemntMarginRight=4;var elemntWidth=parseInt((containerWidth/ElementCount)-elemntMarginRight);this.ListSelector.css('width',elemntWidth);if(!mobileView){this.ListGlobalCountSelector.css('width',elemntWidth);}};SocialToolsClass.prototype.InitFacebookShare=function(){if(this.FacebookAnchor.length>0){this.FacebookAnchor.attr('href',this.FacebookAnchor.attr('href')+this.CurrentUrlEncoded);}};SocialToolsClass.prototype.InitTwitterShare=function(){if(this.TwitterAnchor.length>0){this.TwitterAnchor.attr('href',this.TwitterAnchor.attr('href')+this.CurrentUrlEncoded);this.TwitterAnchor.attr('href',this.TwitterAnchor.attr('href').replace('[[title]]',this.CurrentTitleEncoded));}};SocialToolsClass.prototype.InitLinkedInShare=function(){if(this.LinkedInAnchor.length>0){this.LinkedInAnchor.attr('href',this.LinkedInAnchor.attr('href')+this.CurrentUrlEncoded);}};SocialToolsClass.prototype.InitGooglePlusShare=function(){if(this.GooglePlusAnchor.length>0){this.GooglePlusAnchor.attr('href',this.GooglePlusAnchor.attr('href')+this.CurrentUrlEncoded);}};SocialToolsClass.prototype.InitWeiboShare=function(){if(this.WeiboAnchor.length>0){this.WeiboAnchor.attr('href',this.WeiboAnchor.attr('href')+this.CurrentUrlEncoded);this.WeiboAnchor.attr('href',this.WeiboAnchor.attr('href').replace('[[title]]',this.CurrentTitleEncoded));}};SocialToolsClass.prototype.InitSohuShare=function(){if(this.SohuAnchor.length>0){this.SohuAnchor.attr('href',this.SohuAnchor.attr('href')+this.CurrentUrlEncoded);}};SocialToolsClass.prototype.InitQQShare=function(){if(this.QQAnchor.length>0){this.QQAnchor.attr('href',this.QQAnchor.attr('href')+this.CurrentUrlEncoded);}};SocialToolsClass.prototype.InitRenRenShare=function(){if(this.RenRenAnchor.length>0){this.RenRenAnchor.attr('href',this.RenRenAnchor.attr('href')+this.CurrentUrlEncoded);}};SocialToolsClass.prototype.InitQQShare=function(){if(this.QQAnchor.length>0){this.QQAnchor.attr('href',this.QQAnchor.attr('href')+this.CurrentUrlEncoded);}};SocialToolsClass.prototype.InitSendPageShare=function(){if(this.SendPageAnchor.length>0){this.SendPageAnchor.attr('href',this.SendPageAnchor.attr('href')+this.CurrentUrlEncoded);}};SocialToolsClass.prototype.InitCounters=function(){if(this.FacebookAnchor.length>0||this.TwitterAnchor.length>0||this.LinkedInAnchor.length>0||this.GooglePlusAnchor.length>0||this.WeiboAnchor.length>0||this.RenRenAnchor.length>0||this.QQAnchor.length>0){var _data={url:this.CurrentUrlEncoded,HideFacebook:this.HideFacebook,HideTwitter:this.HideTwitter,HideLinkedIn:this.HideLinkedIn,HideGooglePlus:this.HideGooglePlus,HideWeibo:this.HideWeibo,HideSohu:this.HideSohu,HideQQ:this.HideQQ,HideRenRen:this.HideRenRen,HideSendPage:this.HideSendPage,SendPageUrl:this.SendPageUrl};$.ajax({url:"/servicestack_api/socialcountservice?format=json",cache:false,type:"GET",dataType:"json",data:_data,contentType:"application/json; charset=utf-8",context:this,success:function(data){if(data!=undefined){this.FacebookAnchor.attr('data-count',data.facebookShareCount);this.TwitterAnchor.attr('data-count',data.twitterShareCount);this.LinkedInAnchor.attr('data-count',data.linkedInShareCount);this.GooglePlusAnchor.attr('data-count',data.googlePlusShareCount);this.WeiboAnchor.attr('data-count',data.weiboShareCount);this.RenRenAnchor.attr('data-count',data.renRenShareCount);this.QQAnchor.attr('data-count',data.qqShareCount);this.SendPageAnchor.attr('data-count',data.sendPageShareCount);}else{this.FacebookAnchor.attr('data-count',0);this.TwitterAnchor.attr('data-count',0);this.LinkedInAnchor.attr('data-count',0);this.GooglePlusAnchor.attr('data-count',0);this.WeiboAnchor.attr('data-count',0);this.RenRenAnchor.attr('data-count',0);this.QQAnchor.attr('data-count',0);this.SendPageAnchor.attr('data-count',0);}
this.FacebookAnchor.attr('title',this.SocialButtonTooltipSelector.text().replace('{0}',this.FacebookAnchor.attr('data-count')));this.TwitterAnchor.attr('title',this.SocialButtonTooltipSelector.text().replace('{0}',this.TwitterAnchor.attr('data-count')));this.LinkedInAnchor.attr('title',this.SocialButtonTooltipSelector.text().replace('{0}',this.LinkedInAnchor.attr('data-count')));this.GooglePlusAnchor.attr('title',this.SocialButtonTooltipSelector.text().replace('{0}',this.GooglePlusAnchor.attr('data-count')));this.WeiboAnchor.attr('title',this.SocialButtonTooltipSelector.text().replace('{0}',this.WeiboAnchor.attr('data-count')));this.RenRenAnchor.attr('title',this.SocialButtonTooltipSelector.text().replace('{0}',this.RenRenAnchor.attr('data-count')));this.QQAnchor.attr('title',this.SocialButtonTooltipSelector.text().replace('{0}',this.QQAnchor.attr('data-count')));this.SendPageAnchor.attr('title',this.SocialButtonTooltipSelector.text().replace('{0}',this.SendPageAnchor.attr('data-count')));this.RefreshCounter();},error:function(msg){this.FacebookAnchor.attr('data-count',0);this.TwitterAnchor.attr('data-count',0);this.LinkedInAnchor.attr('data-count',0);this.WeiboAnchor.attr('data-count',0);this.RenRenAnchor.attr('data-count',0);this.QQAnchor.attr('data-count',0);this.GooglePlusAnchor.attr('data-count',0);this.SendPageAnchor.attr('data-count',0);this.FacebookAnchor.attr('title',this.SocialButtonTooltipSelector.text().replace('{0}',this.FacebookAnchor.attr('data-count')));this.TwitterAnchor.attr('title',this.SocialButtonTooltipSelector.text().replace('{0}',this.TwitterAnchor.attr('data-count')));this.LinkedInAnchor.attr('title',this.SocialButtonTooltipSelector.text().replace('{0}',this.LinkedInAnchor.attr('data-count')));this.GooglePlusAnchor.attr('title',this.SocialButtonTooltipSelector.text().replace('{0}',this.GooglePlusAnchor.attr('data-count')));this.WeiboAnchor.attr('title',this.SocialButtonTooltipSelector.text().replace('{0}',this.WeiboAnchor.attr('data-count')));this.RenRenAnchor.attr('title',this.SocialButtonTooltipSelector.text().replace('{0}',this.RenRenAnchor.attr('data-count')));this.QQAnchor.attr('title',this.SocialButtonTooltipSelector.text().replace('{0}',this.QQAnchor.attr('data-count')));this.SendPageAnchor.attr('title',this.SocialButtonTooltipSelector.text().replace('{0}',this.SendPageAnchor.attr('data-count')));this.RefreshCounter();}});}};SocialToolsClass.prototype.RefreshCounter=function(){this.GlobalCount=0;if(this.FacebookAnchor.length>0){this.GlobalCount+=parseInt(this.FacebookAnchor.attr('data-count'));}
if(this.TwitterAnchor.length>0){this.GlobalCount+=parseInt(this.TwitterAnchor.attr('data-count'));}
if(this.LinkedInAnchor.length>0){this.GlobalCount+=parseInt(this.LinkedInAnchor.attr('data-count'));}
if(this.GooglePlusAnchor.length>0){this.GlobalCount+=parseInt(this.GooglePlusAnchor.attr('data-count'));}
if(this.WeiboAnchor.length>0){this.GlobalCount+=parseInt(this.WeiboAnchor.attr('data-count'));}
if(this.RenRenAnchor.length>0){this.GlobalCount+=parseInt(this.RenRenAnchor.attr('data-count'));}
if(this.QQAnchor.length>0){this.GlobalCount+=parseInt(this.QQAnchor.attr('data-count'));}
if(this.SendPageAnchor.length>0){this.GlobalCount+=parseInt(this.SendPageAnchor.attr('data-count'));}
this.GlobalCountWrapper.text(this.GlobalCount);if(this.GlobalCount==0||$('.device1').length>0||this.GlobalCount<this.MininumShareToDisplayCounter){$(this.ListGlobalCountSelector).hide();this.FacebookAnchor.removeAttr('title');this.TwitterAnchor.removeAttr('title');this.LinkedInAnchor.removeAttr('title');this.GooglePlusAnchor.removeAttr('title');this.WeiboAnchor.removeAttr('title');this.RenRenAnchor.removeAttr('title');this.QQAnchor.removeAttr('title');this.SendPageAnchor.removeAttr('title');}else{$(this.ListGlobalCountSelector).show();}};SocialToolsClass.prototype.AddCount=function(media){var _data={Url:this.CurrentUrlEncoded,Method:"Add",Media:media};$.ajax({url:"/servicestack_api/socialcountservice?format=json&url="+this.CurrentUrlEncoded,cache:false,type:"POST",dataType:"json",data:JSON.stringify(_data),contentType:"application/json; charset=utf-8",context:this,success:function(data){if(data!=undefined){this.FacebookAnchor.attr('data-count',data.facebookShareCount);this.TwitterAnchor.attr('data-count',data.twitterShareCount);this.LinkedInAnchor.attr('data-count',data.linkedInShareCount);this.GooglePlusAnchor.attr('data-count',data.googlePlusShareCount);this.WeiboAnchor.attr('data-count',data.weiboShareCount);this.RenRenAnchor.attr('data-count',data.renRenShareCount);this.QQAnchor.attr('data-count',data.qqShareCount);this.FacebookAnchor.attr('title',this.SocialButtonTooltipSelector.text().replace('{0}',this.FacebookAnchor.attr('data-count')));this.TwitterAnchor.attr('title',this.SocialButtonTooltipSelector.text().replace('{0}',this.TwitterAnchor.attr('data-count')));this.LinkedInAnchor.attr('title',this.SocialButtonTooltipSelector.text().replace('{0}',this.LinkedInAnchor.attr('data-count')));this.GooglePlusAnchor.attr('title',this.SocialButtonTooltipSelector.text().replace('{0}',this.GooglePlusAnchor.attr('data-count')));this.WeiboAnchor.attr('title',this.SocialButtonTooltipSelector.text().replace('{0}',this.WeiboAnchor.attr('data-count')));this.RenRenAnchor.attr('title',this.SocialButtonTooltipSelector.text().replace('{0}',this.RenRenAnchor.attr('data-count')));this.QQAnchor.attr('title',this.SocialButtonTooltipSelector.text().replace('{0}',this.QQAnchor.attr('data-count')));this.RefreshCounter();}},error:function(msg){}});};